{{ block title }}
{{ endblock }}
{{ block content }}

<h3 class="center"> Counting Task</h3>

<div class="paragraph-with-icon">
    <img class="task_icon" src="{% static 'global/counting_task_icon.png' %}" alt="task icon logic">

    <p class="center">
    What do you think is the <b>probability</b> that that the team of {{C.NUM_MEMBERS_W}} {{ participant.group }}s won against the
    team of {{C.NUM_MEMBERS_W}} {{participant.outgroup}}s in the <b>Counting Task</b>? <br>
    Remember that it is in your best interest to answer this question as accurately as possible. If you want to read the instructions
    again or want to learn more about the bonus payment, click <b id="instructions_trigger" style="color:blue">here</b>.
    </p>
    <br>
</div>
<div id="logicmodal" class="modal">
    <span id="logicclose" class="close">&times;</span>
    <div id="logiccaption">

<h4> Instructions </h4>
<p> ... To Do ...
    </p>

<h4> Bonus Payment: </h4>
<p>
    ...
</p>


<span style="font-weight:bold"> <u> Example Question:</u> </span> <br>
...

        <br>
</div>
</div>



<div class="slider-wrapper">
    <input id="belief" type="range" step="1" min="0" max="100" oninput="calcBelief()" name="post_direct_effort" class="post_direct_effort notclicked" onclick="activateSlider('belief')">

    <div class="scale">
        <span class="scale-label">0%</span>
        <span class="scale-label">100%</span>
    </div>
</div>
<div id="answer-display" class="hidden">
    <div class="belief_field" style="font-size:18px">
        Your estimate: The probability that the {{ participant.group }}s won against the {{participant.outgroup}}s in the Counting Task is:
    </div>
    <div class="bonus_field">
        <div class="highlight_block">
            <span style="white-space: nowrap;">
                <span id="current-slider-value" style="font-weight:bold; font-size:22px;">&nbsp;</span>
                <span id="percent-symbol" style="font-size:22px; display:none;">%</span>
            </span>
        </div>
    </div>
</div>
<p class="center" id="info_slider">
    <i> (Please click on the slider to activate it and move it to indicate your estimate.) </i>
</p>


{{ formfield_errors 'post_direct_effort' }}

<br>
<div class="center">
    <button id="next-button" class="button-normal" disabled>Next</button>
</div>

{{ endblock }}


{{ block styles}}
<style type="text/css">
.paragraph-with-icon {
    position: relative;
    margin-top: 30px; /* optional spacing */
}

.paragraph-with-icon .task_icon {
    position: absolute;
    top: -65px;     /* position icon above the paragraph */
    right: 40px;       /* align to the right within this container */
    width: 55px;    /* adjust as needed */
    height: auto;
}
.center {
    text-align: center;
    item-align: center;
}
.inline-block {
  display: inline-block;
  white-space: nowrap;
}
input.notclicked[type=range]::-webkit-slider-thumb {
  visibility: hidden;
}

input.notclicked[type=range]::-moz-range-thumb {
  visibility: hidden;
}

input.notclicked[type=range]::-ms-thumb {
  visibility: hidden;
}

#belief {
    width: 75%;
    height: 20px;
    align-items: center;
}
.slider-container {
    display: flex;
    justify-content: center; /* Center horizontally */
    width: 100%;
    margin-top: 10px;
}

.slider-wrapper {
    flex: 5;
    position: relative;
    display: flex;
    flex-direction: column; /* key: stack vertically */
    align-items: center;
    width: 100%; /* ensure it's same as slider */
}

.scale {
    display: flex;
    justify-content: space-between;
    width: 75%; /* match input width */
    padding: 0 2px;
    margin-top: 4px;
    font-size: 14px;
    color: #555;
}

.scale-label {
    text-align: center;
    min-width: 30px;
}

.belief_field{
    font-size: 18px;
    text-align: center;
    margin-top: 20px;
}

.bonus_field {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 10px;
}

.post_direct_effort {
        -webkit-appearance: none;
        width: 100%; /* Set the full width of the screen */
        margin: 0 auto;
        height: 12px;
       border-radius: 4px;
        background: #d3d3d3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
}

.post_direct_effort::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: #2E2E2E;
  cursor: pointer;
  /* opacity: 0; */
}

.post_direct_effort::-moz-range-thumb {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: #2E2E2E;
  cursor: pointer;
  /* opacity: 0; */
}
.visible-thumb {
    opacity: 1 !important;
}

.hidden-input {
    color: white;
    background-color: white;
}

.hidden{
    display:none;
}

.highlight_block {
        /* display: inline-block; */
        padding: 5px;
        background-color: #D8D8D8;
        border-radius: 5px;
        width: 55px;
        text-align: center;
        item-align: center;
    }

.enabled-button{
    background-color: #0B60DB;
    border: none;
    border-radius: 7px;
    color: white;
    padding: 7px 14px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    position: relative;
}

#next-button:disabled {
        background-color: #ECEDEF;
        color: white;
        cursor: not-allowed;
        border: none;
        border-radius: 7px;
        color: white;
        padding: 7px 14px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
    }

.button {
    border-radius: 7px;
    padding: 7px 14px;
    /* background-color: #81DAF5; */
}

.button_normal{
    background-color: #0B60DB;
    border: none;
    border-radius: 7px;
    color: white;
    padding: 7px 14px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
}

input[type=range] {
    background: linear-gradient(to right, #d3d3d3 0%, #d3d3d3 100%); /* #de86f2 */
}

.openbox {
        cursor: pointer;
		margin: 15px 0;
		  }
.modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        padding-top: 100px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.9); /* Black w/ opacity */
        }

    #instructions_trigger:hover{
        cursor: pointer;
        }

    #dict_trigger:hover{
        cursor: pointer;
        }

    #re_trigger:hover{
        cursor: pointer;
        }

    .modal-content {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 700px;
        }

    #logiccaption {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 700px;
        color: #ccc;
        padding: 10px 0;
        height: 150px;
        }

    .modal-content, #caption {
        animation-name: zoom;
        animation-duration: 0.6s;
        }

    @keyframes zoom {
        from {transform:scale(0)}
        to {transform:scale(1)}
        }

    .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: 0.3s;
        }

    .close:hover,
    .close:focus {
        color: #bbb;
        text-decoration: none;
        cursor: pointer;
        }

    @media only screen and (max-width: 700px){
    .modal-content {
        width: 100%;
        }
    }
</style>
{{ endblock }}

{{ block scripts }}
<script>
// Get the modal
var logicmodal = document.getElementById("logicmodal");

// Get the image and insert it inside the modal - use its "alt" text as a caption
var logictrigger = document.getElementById("instructions_trigger");
var logicmodalImg = document.getElementById("logicimg");
var logiccaptionText = document.getElementById("logiccaption");
logictrigger.onclick = function(){
    logicmodal.style.display = "block";
    logiccaptionText.innerHTML = logicmodalImg.alt;
};

// Get the <span> element that closes the modal
var logicspan = document.getElementById("logicclose");

// When the user clicks on <span> (x), close the modal
    logicspan.onclick = function() {
        logicmodal.style.display = "none";
};
</script>
<script>
let nextButton = document.getElementById('next-button');

// Function to enable the next button
function enableNextButton() {
    nextButton.disabled = false;
    nextButton.classList.remove('disabled-button');
    nextButton.classList.add('enabled-button');
}

// Function to disable the Next button
function disableNextButton() {
    nextButton.disabled = true;
    nextButton.classList.remove('enabled-button');
    nextButton.classList.add('disabled-button');
}

</script>

<script>
    // Initialize a flag to check if the slider has been interacted with
   let sliderInteracted = false;

//Function to update the current slider position display
    function calcBelief() {
        // Check if the slider has been interacted with
        if (!sliderInteracted) {
        // If not, simply return without updating the fields
            return;
        }
        const Belief = parseFloat(document.getElementById('belief').value);
        const post_direct_effort = Belief;

        // Update the slider value display for belief
        document.getElementById('current-slider-value').textContent = post_direct_effort.toFixed(0);
        updateSliderColor();

        // Show the percent symbol
        document.getElementById('percent-symbol').style.display = 'inline';
    }


    // This function sets the slider as interacted and updates the display
    function activateSlider() {
        sliderInteracted = true;
        calcBelief();
        enableNextButton();
        document.getElementById("belief").classList.remove('notclicked');
        document.getElementById("answer-display").classList.remove("hidden");
        updateSliderColor();
        removeInfoSlider();

    // Show the percent symbol
    document.getElementById("percent-symbol").style.display = "inline";
    }

    function updateSliderColor() {
    const slider = document.getElementById("belief");
    const value = slider.value;
    const min = slider.min;
    const max = slider.max;

    const percentage = ((value - min) / (max - min)) * 100;

    // Update the background with a purple left side and gray right side
    slider.style.background = `linear-gradient(to right, #16f3f3 0%, #16f3f3 ${percentage}%, #d3d3d3 ${percentage}%, #d3d3d3 100%)`;
    }

    // Add an event listener to the slider to update the display in real-time
    document.getElementById('belief').addEventListener('input', updateSliderAndWageDisplay);

    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('current-slider-value').textContent = '\u00A0\u00A0';
    });


</script>

<script>
let infoSlider = document.getElementById('info_slider');

// Function to remove the info slider text
    function removeInfoSlider() {
    infoSlider.style.display = 'none';
}
</script>

<script>
    document.getElementById("openbox").addEventListener("click", function(){
    document.getElementById("infobox").classList.remove("hidden");
    document.getElementById("container").classList.add("hidden");
    });
</script>
{{ endblock }}