{{ block title }}

{{ endblock }}

{{ block content }}
<h3> Procedure and Payment</h3>
<!--<p>
    Thank you for participating in this study!
</p>-->
<br>
<p>
    <b> This study consists of two parts</b>.
    Part II will take place in <u>{{C.BREAK_DURATION}}</u>.
    <b> You must complete both parts in order to receive your payment</b>, consisting of the participation fee and a possible bonus payment.
</p>

    <hr>

<p>
    {{ if participant.treatment == 'Recall' or participant.treatment == 'BeliefsMemory' }}
    The study consists of {{C.TASKS_PART1_MEMORY}} blocks now and {{C.TASKS_PART2}} blocks in Part II in {{C.BREAK_DURATION}}.
    {{ else }}
    The study consists of {{C.TASKS_PART1_DIRECT}} blocks now and {{C.TASKS_PART2}} blocks in Part II in {{C.BREAK_DURATION}}.
    {{ endif }}
    In each block, you can earn a bonus payment. At the end of the study, one block will be randomly selected to determine
    your bonus payment. This is referred to as the "block-that-counts". Your payoff in this block-that-counts will be added to your participation fee
    and paid out within one week.
    <br>
    Details about the potential bonus payment and instructions will be
    provided before each block.
</p>


    {{ next_button }}

<input type="hidden" name="focus_data" id="id_focus_data" />

{{ endblock }}

{{ block styles}}
<style>
.hidden {
	display:none;
}

    .infobox {
    // background-color:#f0f0f5
    }


.belief_task {
    }

.button {
    border-radius: 7px;
    padding: 7px 14px;
}

</style>
{{ endblock }}

{{ block scripts}}
<script>
    document.getElementById("openbox").addEventListener("click", function(){
    document.getElementById("infobox").classList.remove("hidden");
    document.getElementById("container").classList.add("hidden");
    });
</script>
<script>
let events = [];

// Beispiel-Logik: push/close Events; ersetze durch deine bestehende Logik
let blurStart = null;
window.addEventListener('blur', () => { blurStart = Date.now(); });
window.addEventListener('focus', () => {
    if (blurStart) {
        events.push({ unfocused_duration_ms: Date.now() - blurStart, ts: blurStart });
        blurStart = null;
    }
});

// Schreib das JSON regelmäßig ins hidden field und beim Verlassen
function updateHidden() {
    document.getElementById('id_focus_data').value = JSON.stringify(events);
}
setInterval(updateHidden, 1000);
window.addEventListener('beforeunload', updateHidden);
document.addEventListener('visibilitychange', updateHidden);
</script>
 {{ endblock }}
